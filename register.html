<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register - FaceFlow AI</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <video autoplay muted loop playsinline id="bg-video">
    <source src="bgvid.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>
  <div class="overlay"></div>

  <div class="content-wrapper">
    <div class="container">
      <h1>Create Account</h1>
      <form id="registerForm" action="http://localhost:8080/faceflow_ai1/backend/insert.php" method="post">
        <input type="text" name="username" id="username" placeholder="Username" required>
        <input type="email" name="email" id="email" placeholder="Email Address" required>
        <input type="password" name="password" id="password" placeholder="Password" required>
        <button type="submit">Register</button>
      </form>
      <p>
        Already have an account?
        <a href="index.html" id="loginLink">Login here</a>
      </p>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const registerForm = document.getElementById("registerForm");
      const loginLink = document.getElementById("loginLink");
      const contentWrapper = document.querySelector(".content-wrapper");

      // Handle registration form submission
      registerForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        try {
          const formData = new FormData(registerForm);
          const response = await fetch(registerForm.action, {
            method: "POST",
            body: formData,
          });

          if (!response.ok) {
            throw new Error(`HTTP error: ${response.status}`);
          }

          let data;
          try {
            data = await response.json();
          } catch {
            throw new Error("Invalid JSON response from server");
          }

          if (data.success) {
            alert(data.message || "Registration successful!");
            window.location.href = "http://localhost:8080/faceflow_ai1/index.html";
          } else {
            alert(data.message || "Registration failed. Please try again.");
          }
        } catch (error) {
          console.error("Registration error:", error);
          alert("An error occurred: " + error.message);
        }
      });
      
      // Handle page transition with animation on link click
      loginLink.addEventListener("click", (e) => {
        e.preventDefault();
        contentWrapper.classList.add("fade-out-up");
        setTimeout(() => {
          window.location.href = e.target.href;
        }, 500); // Wait for the animation to finish (0.5s)
      });
    });
  </script>
</body>
</html>